<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <meta name="renderer" content="webkit">
  <meta http-equiv="X-UA-Compatible" content="IE=edge" >
  <link rel="dns-prefetch" href="http://yoursite.com">
  <title>使用SeaJS实现模块化JavaScript开发 | Ktig`s blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="什么是sea.js？SeaJS是一个遵循CommonJS规范的JavaScript模块加载框架，可以实现JavaScript的模块化开发及加载机制。与jQuery等JavaScript框架不同，SeaJS不会扩展封装语言特性，而只是实现JavaScript的模块化及按模块加载。SeaJS的主要目的是令JavaScript开发模块化并可以轻松愉悦进行加载，将前端工程师从繁重的JavaScript文件">
<meta property="og:type" content="article">
<meta property="og:title" content="使用SeaJS实现模块化JavaScript开发">
<meta property="og:url" content="http://yoursite.com/2016/03/01/sea/index.html">
<meta property="og:site_name" content="Ktig`s blog">
<meta property="og:description" content="什么是sea.js？SeaJS是一个遵循CommonJS规范的JavaScript模块加载框架，可以实现JavaScript的模块化开发及加载机制。与jQuery等JavaScript框架不同，SeaJS不会扩展封装语言特性，而只是实现JavaScript的模块化及按模块加载。SeaJS的主要目的是令JavaScript开发模块化并可以轻松愉悦进行加载，将前端工程师从繁重的JavaScript文件">
<meta property="og:image" content="http://img1.ph.126.net/ReBlcZoT9JbqQcdVfpirIQ==/6632174973908016457.jpg">
<meta property="og:updated_time" content="2016-11-08T12:59:48.284Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="使用SeaJS实现模块化JavaScript开发">
<meta name="twitter:description" content="什么是sea.js？SeaJS是一个遵循CommonJS规范的JavaScript模块加载框架，可以实现JavaScript的模块化开发及加载机制。与jQuery等JavaScript框架不同，SeaJS不会扩展封装语言特性，而只是实现JavaScript的模块化及按模块加载。SeaJS的主要目的是令JavaScript开发模块化并可以轻松愉悦进行加载，将前端工程师从繁重的JavaScript文件">
<meta name="twitter:image" content="http://img1.ph.126.net/ReBlcZoT9JbqQcdVfpirIQ==/6632174973908016457.jpg">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link rel="stylesheet" href="/main.css">
  

</head>

<body>
  <div id="container">
    <div class="left-col">
      <div class="overlay"></div>
<div class="intrude-less">
	<header id="header" class="inner">
		<a href="/" class="profilepic">
			
			<img src="https://avatars2.githubusercontent.com/u/22739126?v=3&amp;s=466" class="js-avatar">
			
		</a>

		<hgroup>
		  <h1 class="header-author"><a href="/">Ktig</a></h1>
		</hgroup>

		
		<p class="header-subtitle">心之所指</p>
		

		<nav class="header-menu">
			<ul>
			
				<li><a href="/">主页</a></li>
	        
				<li><a href="/">随笔</a></li>
	        
			</ul>
		</nav>
		<nav class="header-smart-menu">
	        
    		
    			
    			<a class="js-smart-menu" data-idx="0" href="javascript:void(0)">所有文章</a>
    			
    			
            
    			
    			<a class="js-smart-menu" data-idx="1" href="javascript:void(0)">标签</a>
    			
    			
            
    			
    			<a class="js-smart-menu" data-idx="2" href="javascript:void(0)">友链</a>
    			
    			
            
    			
    			<a class="js-smart-menu" data-idx="3" href="javascript:void(0)">关于我</a>
    			
    			
            
		</nav>
		<nav class="header-nav">
			<div class="social">
				
					<a class="github" target="_blank" href="https://github.com/Ktig" title="github">github</a>
		        
					<a class="weibo" target="_blank" href="#" title="weibo">weibo</a>
		        
					<a class="google" target="_blank" href="#" title="google">google</a>
		        
					<a class="zhihu" target="_blank" href="https://www.zhihu.com/people/han-guang-30-89" title="zhihu">zhihu</a>
		        
			</div>
		</nav>
	</header>		
</div>

    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
  	<div class="overlay">
  		<div class="slider-trigger"><i class="icon-list"></i></div>
  		<h1 class="header-author js-mobile-header hide">Ktig</h1>
  	</div>
	<div class="intrude-less">
		<header id="header" class="inner">
			<div class="profilepic">
				
					<img src="https://avatars2.githubusercontent.com/u/22739126?v=3&amp;s=466" class="js-avatar">
				
			</div>
			<hgroup>
			  <h1 class="header-author">Ktig</h1>
			</hgroup>
			
			<p class="header-subtitle">心之所指</p>
			
			<nav class="header-menu">
				<ul>
				
					<li><a href="/">主页</a></li>
		        
					<li><a href="/">随笔</a></li>
		        
				</ul>
			</nav>
			<nav class="header-nav">
				<div class="social">
					
						<a class="github" target="_blank" href="https://github.com/Ktig" title="github">github</a>
			        
						<a class="weibo" target="_blank" href="#" title="weibo">weibo</a>
			        
						<a class="google" target="_blank" href="#" title="google">google</a>
			        
						<a class="zhihu" target="_blank" href="https://www.zhihu.com/people/han-guang-30-89" title="zhihu">zhihu</a>
			        
				</div>
			</nav>
		</header>				
	</div>
</nav>

      <div class="body-wrap">
        <article id="post-sea" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      使用SeaJS实现模块化JavaScript开发
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="什么是sea-js？"><a href="#什么是sea-js？" class="headerlink" title="什么是sea.js？"></a>什么是sea.js？</h2><p>SeaJS是一个遵循CommonJS规范的JavaScript模块加载框架，可以实现JavaScript的模块化开发及加载机制。与jQuery等JavaScript框架不同，SeaJS不会扩展封装语言特性，而只是实现JavaScript的模块化及按模块加载。SeaJS的主要目的是令JavaScript开发模块化并可以轻松愉悦进行加载，将前端工程师从繁重的JavaScript文件及对象依赖处理中解放出来，可以专注于代码本身的逻辑。SeaJS可以与jQuery这类框架完美集成。使用SeaJS可以提高JavaScript代码的可读性和清晰度，解决目前JavaScript编程中普遍存在的依赖关系混乱和代码纠缠等问题，方便代码的编写和维护。</p>
<h2 id="Sea-js的优缺点"><a href="#Sea-js的优缺点" class="headerlink" title="Sea.js的优缺点"></a>Sea.js的优缺点</h2><p><strong>优点：</strong><br>提高可维护性</p>
<p>模块化编程</p>
<p>动态加载，前端性能优化</p>
<p><strong>缺点：</strong><br>实现模块化加载的时候需要先引入sea.js文件，比较耗性能</p>
<p>##Sea.js与Require.js的不同<br>他们都是模块化框架的代表，在模块化定义的方式方面，大同小异，主要是代码的风格和API的不同。</p>
<h2 id="模块化开发规范"><a href="#模块化开发规范" class="headerlink" title="模块化开发规范"></a>模块化开发规范</h2><p>上述提到了CommenJS的规范就是模块化开发规范之一，当然还有诸如CMD、AMD等规范。</p>
<ul>
<li>CMD规范——sea.js（国产）——源于CommenJS</li>
<li>AMD规范——require.js（国外）</li>
<li>CommonJS规范——node.js </li>
</ul>
<h2 id="传统模式-vs-SeaJS模块化"><a href="#传统模式-vs-SeaJS模块化" class="headerlink" title="传统模式 vs SeaJS模块化"></a>传统模式 vs SeaJS模块化</h2><p>假设我们现在正在开发一个Web应用TinyApp，我们决定在TinyApp中使用jQuery框架。TinyApp的首页会用到module1.js，module1.js依赖module2.js和module3.js，同时module3.js依赖module4.js。</p>
<h4 id="传统模式"><a href="#传统模式" class="headerlink" title="传统模式"></a>传统模式</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line">var module1 = &#123;</div><div class="line">    run: function() &#123;</div><div class="line">        return $.merge([&apos;module1&apos;], $.merge(module2.run(), module3.run()));</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"> </div><div class="line">//module2.js</div><div class="line">var module2 = &#123;</div><div class="line">    run: function() &#123;</div><div class="line">        return [&apos;module2&apos;];</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"> </div><div class="line">//module3.js</div><div class="line">var module3 = &#123;</div><div class="line">    run: function() &#123;</div><div class="line">        return $.merge([&apos;module3&apos;], module4.run());</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"> </div><div class="line">//module4.js</div><div class="line">var module4 = &#123;</div><div class="line">    run: function() &#123;</div><div class="line">        return [&apos;module4&apos;];</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>此时index.html需要引用module1.js及其所有下层依赖（注意顺序）：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">&lt;!DOCTYPE HTML&gt;</div><div class="line">&lt;html lang=&quot;zh-CN&quot;&gt;</div><div class="line">&lt;head&gt;</div><div class="line">    &lt;meta charset=&quot;UTF-8&quot;&gt;</div><div class="line">    &lt;title&gt;TinyApp&lt;/title&gt;</div><div class="line">    &lt;script src=&quot;./jquery-min.js&quot;&gt;&lt;/script&gt;</div><div class="line">    &lt;script src=&quot;./module4.js&quot;&gt;&lt;/script&gt;</div><div class="line">    &lt;script src=&quot;./module2.js&quot;&gt;&lt;/script&gt;</div><div class="line">    &lt;script src=&quot;./module3.js&quot;&gt;&lt;/script&gt;</div><div class="line">    &lt;script src=&quot;./module1.js&quot;&gt;&lt;/script&gt;</div><div class="line">&lt;/head&gt;</div><div class="line">&lt;body&gt;</div><div class="line">    &lt;p class=&quot;content&quot;&gt;&lt;/p&gt;</div><div class="line">    &lt;script&gt;</div><div class="line">        $(&apos;.content&apos;).html(module1.run());</div><div class="line">    &lt;/script&gt;</div><div class="line">&lt;/body&gt;</div><div class="line">&lt;/html&gt;</div></pre></td></tr></table></figure></p>
<p>随着项目的进行，js文件会越来越多，依赖关系也会越来越复杂，使得js代码和html里的script列表往往变得难以维护。</p>
<h4 id="SeaJS模块化开发"><a href="#SeaJS模块化开发" class="headerlink" title="SeaJS模块化开发"></a>SeaJS模块化开发</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">&lt;!DOCTYPE HTML&gt;</div><div class="line">&lt;html lang=&quot;zh-CN&quot;&gt;</div><div class="line">&lt;head&gt;</div><div class="line">    &lt;meta charset=&quot;UTF-8&quot;&gt;</div><div class="line">    &lt;title&gt;TinyApp&lt;/title&gt;</div><div class="line">&lt;/head&gt;</div><div class="line">&lt;body&gt;</div><div class="line">    &lt;p class=&quot;content&quot;&gt;&lt;/p&gt;</div><div class="line">    &lt;script src=&quot;./sea.js&quot;&gt;&lt;/script&gt;</div><div class="line">    &lt;script&gt;</div><div class="line">        seajs.use(&apos;./init&apos;, function(init) &#123;</div><div class="line">            init.initPage();</div><div class="line">        &#125;);</div><div class="line">    &lt;/script&gt;</div><div class="line">&lt;/body&gt;</div><div class="line">&lt;/html&gt;</div></pre></td></tr></table></figure>
<p>可以看到html页面不再需要引入所有依赖的js文件，而只是引入一个sea.js，sea.js会处理所有依赖，加载相应的js文件，加载策略可以选择在渲染页面时一次性加载所有js文件，也可以按需加载（用到时才加载响应js）。还有就是<br>index.html加载了init模块，并使用此模块的initPage方法初始化页面数据。具体实现看下文介绍。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div></pre></td><td class="code"><pre><div class="line">define(function(require, exports, module) = &#123;</div><div class="line"> </div><div class="line">    //原jquery.js代码...</div><div class="line"> </div><div class="line">    module.exports = $.noConflict(true);</div><div class="line">&#125;);</div><div class="line"> </div><div class="line">//init.js</div><div class="line">define(function(require, exports, module) = &#123;</div><div class="line">    var $ = require(&apos;jquery&apos;);</div><div class="line">    var m1 = require(&apos;module1&apos;);</div><div class="line"> </div><div class="line">    exports.initPage = function() &#123;</div><div class="line">        $(&apos;.content&apos;).html(m1.run());    </div><div class="line">    &#125;</div><div class="line">&#125;);</div><div class="line"> </div><div class="line">//module1.js</div><div class="line">define(function(require, exports, module) = &#123;</div><div class="line">    var $ = require(&apos;jquery&apos;);</div><div class="line">    var m2 = require(&apos;module2&apos;);</div><div class="line">    var m3 = require(&apos;module3&apos;);</div><div class="line"> </div><div class="line">    exports.run = function() &#123;</div><div class="line">        return $.merge([&apos;module1&apos;], $.merge(m2.run(), m3.run()));    </div><div class="line">    &#125;</div><div class="line">&#125;);</div><div class="line"> </div><div class="line">//module2.js</div><div class="line">define(function(require, exports, module) = &#123;</div><div class="line">    exports.run = function() &#123;</div><div class="line">        return [&apos;module2&apos;];</div><div class="line">    &#125;</div><div class="line">&#125;);</div><div class="line"> </div><div class="line">//module3.js</div><div class="line">define(function(require, exports, module) = &#123;</div><div class="line">    var $ = require(&apos;jquery&apos;);</div><div class="line">    var m4 = require(&apos;module4&apos;);</div><div class="line"> </div><div class="line">    exports.run = function() &#123;</div><div class="line">        return $.merge([&apos;module3&apos;], m4.run());    </div><div class="line">    &#125;</div><div class="line">&#125;);</div><div class="line"> </div><div class="line">//module4.js</div><div class="line">define(function(require, exports, module) = &#123;</div><div class="line">    exports.run = function() &#123;</div><div class="line">        return [&apos;module4&apos;];</div><div class="line">    &#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>
<p>通过上面的js文件，我们发现js代码以模块进行组织，各个模块通过require引入自己依赖的模块，这样代码清晰明了。</p>
<h2 id="下载及安装"><a href="#下载及安装" class="headerlink" title="下载及安装"></a>下载及安装</h2><p>要在项目中使用SeaJS，你所有需要做的准备工作就是下载sea.js然后放到你项目的某个位置。</p>
<p>SeaJS项目目前托管在GitHub上，主页为 <a href="https://github.com/seajs/seajs/" target="_blank" rel="external">https://github.com/seajs/seajs/</a> 。可以到其git库的build目录下下载sea.js（已压缩）或sea-debug.js（未压缩）。</p>
<p>下载完成后放到项目的相应位置，然后在页面中引入，你就可以使用SeaJS了。</p>
<h2 id="SeaJS基本开发原则"><a href="#SeaJS基本开发原则" class="headerlink" title="SeaJS基本开发原则"></a>SeaJS基本开发原则</h2><p>在讨论SeaJS的具体使用前，先介绍一下SeaJS的模块化理念和开发原则。</p>
<p>使用SeaJS开发JavaScript的基本原则就是：一切皆为模块。引入SeaJS后，编写JavaScript代码就变成了编写一个又一个模块，SeaJS中模块的概念有点类似于面向对象中的类——模块可以拥有数据和方法，数据和方法可以定义为公共或私有，公共数据和方法可以供别的模块调用。</p>
<p>另外，每个模块应该都定义在一个单独js文件中，即一个对应一个模块。</p>
<h2 id="模块的定义及编写"><a href="#模块的定义及编写" class="headerlink" title="模块的定义及编写"></a>模块的定义及编写</h2><h4 id="模块定义函数define"><a href="#模块定义函数define" class="headerlink" title="模块定义函数define"></a>模块定义函数define</h4><p>SeaJS中使用“define”函数定义一个模块。下面是SeaJS的官方示例：</p>
<pre><code>define(function(require, exports, module) {
//code of the module...
});
</code></pre><p>上述的函数给了三个参数,意思分别如下：</p>
<ul>
<li>require——模块加载函数，用于记载依赖模块。</li>
<li>exports——接口点，将数据或方法定义在其上则将其暴露给外部调用。</li>
<li>module——模块的元数据。</li>
</ul>
<p>这三个参数可以根据需要选择是否需要显示指定。</p>
<p>下面说一下module。module是一个对象，存储了模块的元信息，具体如下：</p>
<ul>
<li>module.id——模块的ID。</li>
<li>module.dependencies——一个数组，存储了此模块依赖的所有模块的ID列表。</li>
<li>module.exports——与exports指向同一个对象。</li>
</ul>
<h4 id="三种编写模块的模式"><a href="#三种编写模块的模式" class="headerlink" title="三种编写模块的模式"></a>三种编写模块的模式</h4><p>第一种定义模块的模式是基于exports的模式：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">define(function(require, exports, module) &#123;</div><div class="line">    var a = require(&apos;a&apos;); //引入a模块</div><div class="line">    var b = require(&apos;b&apos;); //引入b模块</div><div class="line"> </div><div class="line">    var data1 = 1; //私有数据</div><div class="line"> </div><div class="line">    var func1 = function() &#123; //私有方法</div><div class="line">        return a.run(data1);</div><div class="line">    &#125;</div><div class="line"> </div><div class="line">    exports.data2 = 2; //公共数据</div><div class="line"> </div><div class="line">    exports.func2 = function() &#123; //公共方法</div><div class="line">        return &apos;hello&apos;;</div><div class="line">    &#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>
<p>上面是一种比较“正宗”的模块定义模式。除了将公共数据和方法附加在exports上，也可以直接返回一个对象表示模块，如下面的代码与上面的代码功能相同：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">define(function(require) &#123;</div><div class="line">    var a = require(&apos;a&apos;); //引入a模块</div><div class="line">    var b = require(&apos;b&apos;); //引入b模块</div><div class="line"> </div><div class="line">    var data1 = 1; //私有数据</div><div class="line"> </div><div class="line">    var func1 = function() &#123; //私有方法</div><div class="line">        return a.run(data1);</div><div class="line">    &#125;</div><div class="line"> </div><div class="line">    return &#123;</div><div class="line">        data2: 2,</div><div class="line">        func2: function() &#123;</div><div class="line">            return &apos;hello&apos;;</div><div class="line">        &#125;</div><div class="line">    &#125;;</div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>
<p>如果模块定义没有其它代码，只返回一个对象，还可以有如下简化写法：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">define(&#123;</div><div class="line">    data: 1,</div><div class="line">    func: function() &#123;</div><div class="line">        return &apos;hello&apos;;</div><div class="line">    &#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>
<p>第三种方法对于定义纯JSON数据的模块非常合适。</p>
<h2 id="模块的载入和引用"><a href="#模块的载入和引用" class="headerlink" title="模块的载入和引用"></a>模块的载入和引用</h2><p>绝对路径：</p>
<pre><code>require(&quot;http://example/js/a&quot;);
</code></pre><p>相对路径：</p>
<pre><code>require(&quot;./c&quot;);
</code></pre><p>根据应用场景的不同，SeaJS提供了三个载入模块的API，分别是seajs.use，require和require.async，下面分别介绍。</p>
<h4 id="seajs-use"><a href="#seajs-use" class="headerlink" title="seajs.use"></a>seajs.use</h4><p>seajs.use主要用于载入入口模块。入口模块相当于C程序的main函数，同时也是整个模块依赖树的根。上面在TinyApp小例子中，init就是入口模块。seajs.use用法如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">//单一模式</div><div class="line">seajs.use(&apos;./a&apos;);</div><div class="line"> </div><div class="line">//回调模式</div><div class="line">seajs.use(&apos;./a&apos;, function(a) &#123;</div><div class="line">  a.run();</div><div class="line">&#125;);</div><div class="line"> </div><div class="line">//多模块模式</div><div class="line">seajs.use([&apos;./a&apos;, &apos;./b&apos;], function(a, b) &#123;</div><div class="line">  a.run();</div><div class="line">  b.run();</div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>
<p>一般seajs.use只用在页面载入入口模块，SeaJS会顺着入口模块解析所有依赖模块并将它们加载。如果入口模块只有一个，也可以通过给引入sea.js的script标签加入”data-main”属性来省略seajs.use，例如，上面TinyApp的index.html也可以改为如下写法会更简洁：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">&lt;!DOCTYPE HTML&gt;</div><div class="line">&lt;html lang=&quot;zh-CN&quot;&gt;</div><div class="line">&lt;head&gt;</div><div class="line">    &lt;meta charset=&quot;UTF-8&quot;&gt;</div><div class="line">    &lt;title&gt;TinyApp&lt;/title&gt;</div><div class="line">&lt;/head&gt;</div><div class="line">&lt;body&gt;</div><div class="line">    &lt;p class=&quot;content&quot;&gt;&lt;/p&gt;</div><div class="line">    &lt;script src=&quot;./sea.js&quot; data-main=&quot;./init&quot;&gt;&lt;/script&gt;</div><div class="line">&lt;/body&gt;</div><div class="line">&lt;/html&gt;</div></pre></td></tr></table></figure></p>
<h4 id="require"><a href="#require" class="headerlink" title="require"></a>require</h4><p>require是SeaJS主要的模块加载方法，当在一个模块中需要用到其它模块时一般用require加载：</p>
<pre><code>var m = require(&apos;/path/to/module/file&apos;);
</code></pre><p>这里简要介绍一下SeaJS的自动加载机制。上文说过，使用SeaJS后html只要包含sea.js即可，那么其它js文件是如何加载进来的呢？SeaJS会首先下载入口模块，然后顺着入口模块使用正则表达式匹配代码中所有的require，再根据require中的文件路径标识下载相应的js文件，对下载来的js文件再迭代进行类似操作。整个过程类似图的遍历操作（因为可能存在交叉循环依赖所以整个依赖数据结构是一个图而不是树）。</p>
<p>明白了上面这一点，下面的规则就很好理解了：</p>
<p>传给require的路径标识必须是字符串字面量，不能是表达式，如下面使用require的方法是错误的：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">require(&apos;module&apos; + &apos;1&apos;);</div><div class="line"> </div><div class="line">require(&apos;Module&apos;.toLowerCase());</div></pre></td></tr></table></figure></p>
<h4 id="require-async"><a href="#require-async" class="headerlink" title="require.async"></a>require.async</h4><p>上文说过SeaJS会在html页面打开时通过静态分析一次性记载所有需要的js文件，如果想要某个js文件在用到时才下载，可以使用require.async：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">require.async(&apos;/path/to/module/file&apos;, function(m) &#123;</div><div class="line">    //code of callback...</div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>
<p>这样只有在用到这个模块时，对应的js文件才会被下载，也就实现了JavaScript代码的按需加载。</p>
<h2 id="SeaJS的全局配置"><a href="#SeaJS的全局配置" class="headerlink" title="SeaJS的全局配置"></a>SeaJS的全局配置</h2><p>SeaJS提供了一个seajs.config方法可以设置全局配置，接收一个表示全局配置的配置对象。具体使用方法如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">seajs.config(&#123;</div><div class="line">    base: &apos;path/to/jslib/&apos;,</div><div class="line">    alias: &#123;</div><div class="line">      &apos;app&apos;: &apos;path/to/app/&apos;</div><div class="line">    &#125;,</div><div class="line">    charset: &apos;utf-8&apos;,</div><div class="line">    timeout: 20000,</div><div class="line">    debug: false</div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>
<p>这里base表示的路径是基址路径。假如基址路径的地址是 example.com/js/3-party/ ，在执行下面的代码的时候：</p>
<pre><code>var $ = require(&apos;jquery&apos;);
</code></pre><p>会载入  example.com/js/3-party/jquery.js 。</p>
<p>alias可以对较长的常用路径设置缩写。</p>
<p>charset表示下载js时script标签的charset属性。</p>
<p>timeout表示下载文件的最大时长，以毫秒为单位。</p>
<p>debug表示是否工作在调试模式下。</p>
<h2 id="一个完整的例子"><a href="#一个完整的例子" class="headerlink" title="一个完整的例子"></a>一个完整的例子</h2><p>上文说了那么多，知识点比较分散，所以最后我打算用一个完整的SeaJS例子把这些知识点串起来，方便朋友们归纳回顾。这个例子包含如下文件：</p>
<ul>
<li>index.html——主页面。</li>
<li>sea.js——SeaJS脚本。</li>
<li>init.js——init模块，入口模块，依赖data、jquery、style三个模块。由主页面载入。</li>
<li>data.js——data模块，纯json数据模块，由init载入。</li>
<li>jquery.js——jquery模块，对 jQuery库的模块化封装，由init载入。</li>
<li>style.css——CSS样式表，作为style模块由init载入。</li>
<li>ea.js和jquery.js的代码属于库代码，就不赘述，这里只给出自己编写的文件的代码。</li>
</ul>
<p>html：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">&lt;!DOCTYPE HTML&gt;</div><div class="line">&lt;html lang=&quot;zh-CN&quot;&gt;</div><div class="line">&lt;head&gt;</div><div class="line">    &lt;meta charset=&quot;UTF-8&quot;&gt;</div><div class="line">    &lt;title&gt;&lt;/title&gt;</div><div class="line">&lt;/head&gt;</div><div class="line">&lt;body&gt;</div><div class="line">&lt;div id=&quot;content&quot;&gt;</div><div class="line">    &lt;p class=&quot;author&quot;&gt;&lt;/p&gt;</div><div class="line">    &lt;p class=&quot;blog&quot;&gt;&lt;a href=&quot;#&quot;&gt;Blog&lt;/a&gt;&lt;/p&gt;</div><div class="line">&lt;/div&gt;</div><div class="line"> </div><div class="line">&lt;script src=&quot;./sea.js&quot; data-main=&quot;./init&quot;&gt;&lt;/script&gt;</div><div class="line">&lt;/body&gt;</div><div class="line">&lt;/html&gt;</div></pre></td></tr></table></figure></p>
<p>css：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">.author&#123;color:red;font-size:10pt;&#125;</div><div class="line">.blog&#123;font-size:10pt;&#125;</div></pre></td></tr></table></figure></p>
<p>javascript：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">//init.js</div><div class="line">define(function(require, exports, module) &#123;</div><div class="line">    var $ = require(&apos;./jquery&apos;);</div><div class="line">    var data = require(&apos;./data&apos;);</div><div class="line">    var css = require(&apos;./style.css&apos;);</div><div class="line"> </div><div class="line">    $(&apos;.author&apos;).html(data.author);</div><div class="line">    $(&apos;.blog&apos;).attr(&apos;href&apos;, data.blog);</div><div class="line">&#125;);</div><div class="line"> </div><div class="line">//data.js</div><div class="line">define(&#123;</div><div class="line">    author: &apos;Ktig&apos;,</div><div class="line">    blog: &apos;http://Ktig.github.io&apos;</div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>
<p>效果如下：<br><img src="http://img1.ph.126.net/ReBlcZoT9JbqQcdVfpirIQ==/6632174973908016457.jpg" alt=""></p>

      
    </div>
    <div class="article-info article-info-index">
      
      <a href="/2016/03/01/sea/" class="archive-article-date">
  	<time datetime="2016-03-01T04:33:20.000Z" itemprop="datePublished"><i class="icon-clock"></i>2016-03-01</time>
</a>
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags"></i>
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/sea-js/">sea.js</a></li></ul>
	</div>

      

      <div class="clearfix"></div>
    </div>
  </div>
</article>

  
<nav id="article-nav">
  
    <a href="/2016/04/20/webpack/" id="article-nav-newer" class="article-nav-link-wrap">
      <i class="icon-circle-left"></i>
      <div class="article-nav-title">
        
          webpack的学习之路
        
      </div>
    </a>
  
  
    <a href="/2015/11/25/git/" id="article-nav-older" class="article-nav-link-wrap">
      <div class="article-nav-title">开始Git学习</div>
      <i class="icon-circle-right"></i>
    </a>
  
</nav>




<div class="share_jia">
	<!-- JiaThis Button BEGIN -->
	<div class="jiathis_style">
		<span class="jiathis_txt">Share to: &nbsp; </span>
		<a class="jiathis_button_facebook"></a> 
	    <a class="jiathis_button_twitter"></a>
	    <a class="jiathis_button_plus"></a> 
	    <a class="jiathis_button_tsina"></a>
		<a class="jiathis_button_cqq"></a>
		<a class="jiathis_button_douban"></a>
		<a class="jiathis_button_weixin"></a>
		<a class="jiathis_button_tumblr"></a>
    <a href="http://www.jiathis.com/share" class="jiathis jiathis_txt jtico jtico_jiathis" target="_blank"></a>
	</div>
	<script type="text/javascript" src="//v3.jiathis.com/code/jia.js?uid=1405949716054953" charset="utf-8"></script>
	<!-- JiaThis Button END -->
</div>









      </div>
      <footer id="footer">
  <div class="outer">
    <div id="footer-info">
    	<div class="footer-left">
    		&copy; 2016 Ktig
    	</div>
      	<div class="footer-right">	
              <span>本站的主题：<span style='color:green'>Yilia</span></span>
          </span>
      	</div>
    </div>
  </div>
</footer>
    </div>
    <script>
	var yiliaConfig = {
		fancybox: true,
		mathjax: false,
		animate: true,
		isHome: false,
		isPost: true,
		isArchive: false,
		isTag: false,
		isCategory: false,
		open_in_new: false,
		root: "/",
		innerArchive: true
	}
</script>

<script src="/./main.js"></script>



    
<div class="tools-col">
  <ul class="btn-wrap">
    
      <li class="chose" data-hook="tools-section-all"><span class="text">全部</span><i class="icon-book"></i></li>
    
    
      <li data-hook="tools-section-tag"><span class="text">标签</span><i class="icon-price-tags"></i></li>
    
    
      <li data-hook="tools-section-friends"><span class="text">友链</span><i class="icon-link"></i></li>
    
    
      <li data-hook="tools-section-me"><span class="text">我</span><i class="icon-smile"></i></li>
    
  </ul>
  <div class="tools-wrap">
    
    	<section class="tools-section tools-section-all chose">
    	</section>
    

    
    	<section class="tools-section tools-section-tag">
    			<div class="widget tagcloud" id="js-tagcloud">
    				<a href="/tags/CSS/" style="font-size: 15px;">CSS</a> <a href="/tags/DOM/" style="font-size: 10px;">DOM</a> <a href="/tags/Git/" style="font-size: 10px;">Git</a> <a href="/tags/JavaScript/" style="font-size: 20px;">JavaScript</a> <a href="/tags/MarkDown/" style="font-size: 10px;">MarkDown</a> <a href="/tags/node-js/" style="font-size: 10px;">node.js</a> <a href="/tags/sea-js/" style="font-size: 10px;">sea.js</a> <a href="/tags/webpack/" style="font-size: 10px;">webpack</a> <a href="/tags/前端引擎/" style="font-size: 10px;">前端引擎</a> <a href="/tags/对比/" style="font-size: 10px;">对比</a> <a href="/tags/数据库/" style="font-size: 10px;">数据库</a>
    			</div>
    	</section>
    

    
    	<section class="tools-section tools-section-friends">
  		
  			<div class="friends-wrap" id="js-friends">
  			
  	          <a target="_blank" class="main-nav-link switch-friends-link" href="http://www.liaoxuefeng.com/">廖雪峰</a>
  	        
  	          <a target="_blank" class="main-nav-link switch-friends-link" href="http://www.ruanyifeng.com/home.html/">阮一峰</a>
  	        
  	          <a target="_blank" class="main-nav-link switch-friends-link" href="http://www.zhangxinxu.com/">张鑫旭</a>
  	        
  	          <a target="_blank" class="main-nav-link switch-friends-link" href="http://www.barretlee.com/entry/">小胡子哥</a>
  	        
  	          <a target="_blank" class="main-nav-link switch-friends-link" href="http://taobaofed.org/">淘宝前端团队</a>
  	        
  	          <a target="_blank" class="main-nav-link switch-friends-link" href="http://fex.baidu.com/">百度前端研发部</a>
  	        
  	        </div>
  		
    	</section>
    

    
    	<section class="tools-section tools-section-me">
  	  	
  	  		<div class="aboutme-wrap" id="js-aboutme">未曾一次退败&lt;br&gt;&lt;br&gt;未尝得一知己</div>
  	  	
    	</section>
    
  </div>
  
</div>
    <!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    <!-- Background of PhotoSwipe. 
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>

    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">

        <!-- Container that holds slides. 
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                <!--  Controls are self-explanatory. Order can be changed. -->

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" style="display:none" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                <!-- Preloader demo http://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                      <div class="pswp__preloader__cut">
                        <div class="pswp__preloader__donut"></div>
                      </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div> 
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div>
  </div>
</body>
</html>